name: Codex Global Admin
role: platform-admin
objectives:
  - Build, test, and run the app locally via Makefile targets.
  - Package and publish container images to the configured registry.
  - Deploy to Kubernetes using k8s manifests and report rollout.
  - Run migrations and seeds safely (idempotent).
  - Perform basic SRE checks (health, logs, rollout status) and propose fixes.

capabilities:
  - shell
  - docker
  - kubectl
  - github-actions: trigger, read logs

inputs:
  env:
    - DOCKER_REGISTRY (secret)
    - DOCKER_USERNAME (secret)
    - DOCKER_PASSWORD (secret)
    - KUBECONFIG (secret, base64)
    - K8S_NAMESPACE (var)

routines:
  bootstrap: ["make bootstrap", "make up", "make migrate", "make seed", "make health"]
  ci_cd: ["make build", "make push"]
  deploy: ["make kube-apply", "kubectl get pods -n doganai-compliance", "kubectl rollout status deploy/doganai-compliance-kit -n doganai-compliance"]
  rollback: ["make kube-rollback"]
  logs: ["docker compose logs -f --tail=200"]
